<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="mobile-web-app-capable" content="yes">
    <title>Property Management System</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }

        body {
display: flex;
  justify-content: center;
  align-items: flex-start;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
            padding-bottom: 70px;
            overflow-x: hidden;
            max-width: 100vw;
        }

        .container {
            width: 100%;
  max-width: 430px; /* fixed mobile width */
  margin: 0 auto;
  min-height: 100vh;
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  border-radius: 0;
  overflow: hidden;
  box-shadow: 0 0 25px rgba(0, 0, 0, 0.15);
        }

        /* Bottom Navigation Bar */
       /* Centered bottom navigation inside the mobile container */
.bottom-nav {
  position: fixed;
  bottom: 0;
  left: 50%;
  transform: translateX(-50%);
  width: 100%;
  max-width: 430px;  /* match phone width */
  background: white;
  box-shadow: 0 -2px 10px rgba(0, 0, 0, 0.15);
  display: flex;
  justify-content: space-around;
  align-items: center;
  padding: 8px 0 calc(8px + env(safe-area-inset-bottom));
  height: 70px;
  border-top: 1px solid #eee;
  z-index: 1000;
  border-radius: 0 0 20px 20px;
}

        .nav-item {
            flex: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: 4px;
            cursor: pointer;
            transition: all 0.2s ease;
            color: #888;
            padding: 8px 4px;
            border: none;
            background: none;
            position: relative;
            -webkit-tap-highlight-color: transparent;
            touch-action: manipulation;
        }

        .nav-item:active {
            transform: scale(0.9);
            background: #f5f5f5;
            border-radius: 8px;
        }

        .nav-item.active {
            color: #667eea;
        }

        .nav-item.active::before {
            content: '';
            position: absolute;
            top: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 30px;
            height: 3px;
            background: #667eea;
            border-radius: 0 0 3px 3px;
        }

        .nav-item i {
            font-size: 20px;
        }

        .nav-item span {
            font-size: 10px;
            font-weight: 500;
        }

        /* Main Content */
        .main-content {
            padding: 12px;
            max-width: 100vw;
            overflow-x: hidden;
        }

        .page {
            display: none;
        }

        .page.active {
            display: block;
            animation: fadeIn 0.3s ease;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .page-header {
            background: white;
            padding: 16px;
            border-radius: 12px;
            margin-bottom: 12px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        .page-header h1 {
            color: #333;
            font-size: 22px;
            margin-bottom: 4px;
        }

        .page-header p {
            color: #777;
            font-size: 13px;
        }

        /* Dashboard Cards */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            margin-bottom: 12px;
        }

        .stat-card {
            background: white;
            padding: 14px;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            position: relative;
            overflow: hidden;
        }

        .stat-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 3px;
            background: linear-gradient(90deg, #667eea, #764ba2);
        }

        .stat-card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }

        .stat-card h3 {
            color: #777;
            font-size: 11px;
            font-weight: 600;
            text-transform: uppercase;
        }

        .stat-icon {
            width: 36px;
            height: 36px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
            color: white;
        }

        .stat-value {
            font-size: 24px;
            font-weight: 700;
            color: #333;
            margin-bottom: 6px;
        }

        .stat-change {
            font-size: 11px;
            color: #10b981;
            display: flex;
            align-items: center;
            gap: 4px;
        }

        .stat-change.negative {
            color: #ef4444;
        }

        /* Property Management Form */
        .add-property-container {
            background: #fff;
            border-radius: 12px;
            padding: 16px;
            margin-bottom: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        .title {
            text-align: center;
            color: #667eea;
            font-weight: 700;
            font-size: 18px;
            margin-bottom: 4px;
        }

        .subtitle {
            text-align: center;
            color: #666;
            font-size: 12px;
            margin-bottom: 16px;
        }

        .step-tabs {
            display: flex;
            justify-content: center;
            gap: 6px;
            margin-bottom: 16px;
            flex-wrap: wrap;
        }

        .step-btn {
            background: #eee;
            border: none;
            padding: 8px 14px;
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.2s ease;
            font-size: 12px;
            touch-action: manipulation;
        }

        .step-btn:active {
            transform: scale(0.95);
        }

        .step-btn.active {
            background: #667eea;
            color: white;
        }

        .step-content {
            display: none;
        }

        .step-content.active {
            display: block;
        }

        .form-group {
            margin-bottom: 14px;
        }

        .form-group label {
            display: block;
            margin-bottom: 6px;
            color: #555;
            font-weight: 600;
            font-size: 13px;
        }

        .form-group input,
        .form-group select {
            width: 100%;
            padding: 12px;
            border-radius: 8px;
            border: 2px solid #e5e5e5;
            font-size: 16px;
            transition: all 0.2s ease;
            -webkit-appearance: none;
        }

        .form-group input:focus,
        .form-group select:focus {
            outline: none;
            border-color: #667eea;
        }

        .buttons {
            display: flex;
            justify-content: space-between;
            margin-top: 16px;
            gap: 10px;
        }

        .next-btn, .back-btn {
            background: #667eea;
            color: #fff;
            border: none;
            padding: 14px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            flex: 1;
            touch-action: manipulation;
        }

        .back-btn {
            background: #999;
        }

        .next-btn:active, .back-btn:active {
            transform: scale(0.97);
        }

        /* Sub Tabs */
       .sub-tabs {
  display: flex;
  gap: 10px;
  margin-bottom: 15px;
}
.sub-btn {
  flex: 1;
  padding: 10px;
  border: 1px solid #ccc;
  background: #f8f8ff;
  border-radius: 6px;
  cursor: pointer;
}
.sub-btn.active {
  background: #ebe9ff;
  color: #4a2fd4;
  border-color: #4a2fd4;
}

.card {
  background: #fff;
  border: 1px solid #eee;
  border-radius: 8px;
  padding: 15px;
  margin-bottom: 15px;
  box-shadow: 0 1px 3px rgba(0,0,0,0.08);
}
.card.yellow { background: #fffbea; }
.card.green { background: #e9fff0; }

.form-row, .expense-group {
  margin-bottom: 10px;
}
.expense-item,.add-row{display:flex;gap:6px;margin-bottom:8px}
.expense-item input,.add-row input{flex:1;padding:8px;border-radius:6px;border:1px solid #ccc}
.expense-item button{background:#ff4d4f;color:#fff;border:none;border-radius:6px;padding:4px 10px;cursor:pointer}
.add-row button,.add-btn{background:#4a2fd4;color:#fff;border:none;border-radius:6px;padding:8px 12px;cursor:pointer}
.summary-box{background:#f5f4ff;border-radius:8px;padding:12px;margin-top:10px}
.dynamic-summary{background:#edfaff;border-radius:8px;padding:12px;margin-top:15px}
.form-row label {
  display: block;
  font-weight: 500;
  margin-bottom: 4px;
}
input[type="number"], input[type="text"] {
  width: 100%;
  padding: 8px;
  border-radius: 6px;
  border: 1px solid #ccc;
}
.add-revenue input {
  width: calc(50% - 10px);
}
.add-revenue button {
  background: #4a2fd4;
  color: #fff;
  border: none;
  border-radius: 6px;
  padding: 8px 14px;
  cursor: pointer;
}
.revenue-item {
  display: flex;
  gap: 6px;
  margin-bottom: 8px;
}
.revenue-item input {
  flex: 1;
}
.revenue-item button {
  background: #ff4d4f;
  color: white;
  border: none;
  border-radius: 5px;
  cursor: pointer;
}
.summary-box {
  background: #f5f4ff;
  border-radius: 8px;
  padding: 12px;
  font-weight: 500;
}
.dynamic-summary {
  background: #edfaff;
  border-radius: 8px;
  padding: 12px;
  margin-top: 15px;
}.buttons{display:flex;justify-content:space-between;margin-top:20px}
.next-btn,.back-btn{border:none;padding:10px 20px;border-radius:8px;font-weight:600;cursor:pointer}
.next-btn{background:#4a2fd4;color:#fff}
.back-btn{background:#f1f1f1;color:#444}
        .sub-btn.active {
            background: #667eea;
            color: white;
        }

        .sub-tab {
            display: none;
        }

        .sub-tab.active {
            display: block;
        }

        /* Upload Section */
        .upload-box {
            border: 2px dashed #a88df0;
            border-radius: 10px;
            background: #f5f3ff;
            padding: 24px 16px;
            text-align: center;
            cursor: pointer;
            margin-bottom: 14px;
            touch-action: manipulation;
        }

        .upload-box input {
            display: none;
        }

        .cloud-icon {
            font-size: 32px;
            color: #667eea;
        }

        .upload-box p {
            margin-top: 8px;
            font-size: 13px;
            color: #333;
        }

        .upload-box span {
            font-size: 11px;
            color: #777;
        }

        .preview-container {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            justify-content: center;
        }

        .preview-container img {
            width: 70px;
            height: 70px;
            object-fit: cover;
            border-radius: 8px;
            border: 2px solid #ddd;
        }

        /* Slider */
        .slider-group {
            margin: 16px 0;
        }

        .slider-group label {
            display: block;
            margin-bottom: 8px;
            font-size: 13px;
            font-weight: 600;
            color: #555;
        }

        .slider-group input {
            width: 100%;
            height: 6px;
        }

        .summary-box {
            background: #f0f7ff;
            padding: 12px;
            border-radius: 8px;
            margin-top: 14px;
            border-left: 4px solid #667eea;
        }

        .summary-box p {
            font-size: 13px;
            color: #333;
        }

        /* Property Grid */
        .property-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 12px;
        }

        .property-card {
            background: white;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        .property-image {
            height: 160px;
            background-size: cover;
            background-position: center;
            position: relative;
        }

        .property-badge {
            position: absolute;
            top: 10px;
            right: 10px;
            background: rgba(255, 255, 255, 0.95);
            padding: 5px 10px;
            border-radius: 12px;
            font-size: 10px;
            font-weight: 600;
        }

        .property-badge.rented {
            color: #10b981;
        }

        .property-badge.available {
            color: #667eea;
        }

        .property-badge.maintenance {
            color: #f59e0b;
        }

        .property-content {
            padding: 12px;
        }

        .property-title {
            font-size: 16px;
            font-weight: 700;
            color: #333;
            margin-bottom: 6px;
        }

        .property-location {
            color: #777;
            font-size: 12px;
            display: flex;
            align-items: center;
            gap: 4px;
            margin-bottom: 10px;
        }

        .property-details {
            display: flex;
            gap: 12px;
            margin-bottom: 10px;
            padding-top: 10px;
            border-top: 1px solid #f0f0f0;
        }

        .property-detail {
            display: flex;
            align-items: center;
            gap: 5px;
            font-size: 11px;
            color: #555;
        }

        .property-detail i {
            color: #667eea;
        }

        .property-footer {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .property-price {
            font-size: 18px;
            font-weight: 700;
            color: #667eea;
        }

        .property-actions {
            display: flex;
            gap: 6px;
        }

        .btn-icon {
            width: 32px;
            height: 32px;
            border-radius: 8px;
            border: none;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            touch-action: manipulation;
        }

        .btn-view {
            background: #e0f2fe;
            color: #0284c7;
        }

        .btn-clone {
            background: #fef3c7;
            color: #d97706;
        }

        .btn-edit {
            background: #f0f0f0;
            color: #667eea;
        }

        .btn-delete {
            background: #fee;
            color: #ef4444;
        }

        .btn-icon:active {
            transform: scale(0.9);
        }

        /* Cash Flow */
        .cash-flow-cards {
            display: grid;
            grid-template-columns: 1fr;
            gap: 12px;
            margin-bottom: 12px;
        }

        .flow-card {
            background: white;
            padding: 16px;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        .flow-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 12px;
        }

        .flow-title {
            font-size: 13px;
            color: #777;
            font-weight: 600;
        }

        .flow-amount {
            font-size: 24px;
            font-weight: 700;
            margin-bottom: 4px;
        }

        .flow-amount.income {
            color: #10b981;
        }

        .flow-amount.expense {
            color: #ef4444;
        }

        .flow-amount.profit {
            color: #667eea;
        }

        .transaction-list {
            background: white;
            padding: 16px;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        .transaction-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 0;
            border-bottom: 1px solid #f0f0f0;
        }

        .transaction-item:last-child {
            border-bottom: none;
        }

        .transaction-info h4 {
            font-size: 13px;
            color: #333;
            margin-bottom: 4px;
        }

        .transaction-info p {
            font-size: 11px;
            color: #777;
        }

        .transaction-amount {
            font-size: 15px;
            font-weight: 700;
        }

        .transaction-amount.income {
            color: #10b981;
        }

        /* Settings */
        .settings-section {
            background: white;
            padding: 16px;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            margin-bottom: 12px;
        }

        .settings-section h3 {
            font-size: 15px;
            color: #333;
            margin-bottom: 12px;
            padding-bottom: 10px;
            border-bottom: 2px solid #f0f0f0;
        }

        .setting-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 0;
            border-bottom: 1px solid #f5f5f5;
        }

        .setting-item:last-child {
            border-bottom: none;
        }

        .setting-info h4 {
            font-size: 13px;
            color: #333;
            margin-bottom: 4px;
        }

        .setting-info p {
            font-size: 12px;
            color: #777;
        }

        .toggle-switch {
            position: relative;
            width: 50px;
            height: 26px;
        }

        .toggle-switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }

        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #ccc;
            transition: 0.3s;
            border-radius: 34px;
        }

        .slider:before {
            position: absolute;
            content: "";
            height: 18px;
            width: 18px;
            left: 4px;
            bottom: 4px;
            background-color: white;
            transition: 0.3s;
            border-radius: 50%;
        }

        input:checked + .slider {
            background-color: #667eea;
        }

        input:checked + .slider:before {
            transform: translateX(24px);
        }

        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 14px 20px;
            border: none;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            width: 100%;
            justify-content: center;
            margin-top: 10px;
            touch-action: manipulation;
        }

        .btn-primary:active {
            transform: scale(0.97);
        }

        /* Search Filter */
        .search-filter {
            background: white;
            padding: 12px;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            margin-bottom: 12px;
        }

        .search-box {
            position: relative;
            margin-bottom: 10px;
        }

        .search-box input {
            width: 100%;
            padding: 12px 40px 12px 12px;
            border: 2px solid #e5e5e5;
            border-radius: 8px;
            font-size: 16px;
        }

        .search-box input:focus {
            outline: none;
            border-color: #667eea;
        }

        .search-icon {
            position: absolute;
            right: 12px;
            top: 50%;
            transform: translateY(-50%);
            color: #777;
        }

        .filter-select {
            padding: 12px;
            border: 2px solid #e5e5e5;
            border-radius: 8px;
            font-size: 16px;
            background: white;
            width: 100%;
            margin-bottom: 10px;
            -webkit-appearance: none;
        }

        .filter-select:last-child {
            margin-bottom: 0;
        }

        .filter-select:focus {
            outline: none;
            border-color: #667eea;
        }

        .empty-state {
            text-align: center;
            padding: 40px 20px;
            color: #777;
        }

        .empty-state i {
            font-size: 48px;
            margin-bottom: 12px;
            color: #ccc;
        }

        .empty-state h3 {
            font-size: 16px;
            margin-bottom: 6px;
            color: #555;
        }

        /* Modal */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 2000;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background: white;
            border-radius: 12px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);
            max-width: 90%;
            width: 100%;
        }

        .modal-header {
            padding: 16px;
            border-bottom: 2px solid #f0f0f0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .modal-header h3 {
            font-size: 16px;
            color: #333;
        }

        .modal-close {
            background: none;
            border: none;
            font-size: 24px;
            color: #777;
            cursor: pointer;
            padding: 0;
            width: 32px;
            height: 32px;
        }

        .modal-body {
            padding: 16px;
        }

        .modal-footer {
            padding: 12px 16px;
            border-top: 2px solid #f0f0f0;
            display: flex;
            justify-content: flex-end;
            gap: 10px;
        }

        .btn-secondary {
            background: #f0f0f0;
            color: #555;
            padding: 12px 20px;
            border: none;
            border-radius: 8px;
            font-size: 14px;
            cursor: pointer;
            touch-action: manipulation;
        }

        .btn-secondary:active {
            transform: scale(0.95);
        }

        .btn-danger {
            background: #ef4444;
            color: white;
            padding: 12px 20px;
            border: none;
            border-radius: 8px;
            font-size: 14px;
            cursor: pointer;
            touch-action: manipulation;
        }

        .btn-danger:active {
            transform: scale(0.95);
        }
    </style>
</head>
<body>
    <div class="container">
        <main class="main-content">
            <!-- Dashboard Page -->
            <div id="dashboard" class="page active">
                <div class="page-header">
                    <h1>Dashboard</h1>
                    <p>Welcome back! Here's your property overview</p>
                </div>

                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-card-header">
                            <h3>Properties</h3>
                            <div class="stat-icon" style="background: linear-gradient(135deg, #667eea, #764ba2);">
                                <i class="fas fa-building"></i>
                            </div>
                        </div>
                        <div class="stat-value" id="totalProperties">3</div>
                        <div class="stat-change">
                            <i class="fas fa-arrow-up"></i> Active
                        </div>
                    </div>

                    <div class="stat-card">
                        <div class="stat-card-header">
                            <h3>Revenue</h3>
                            <div class="stat-icon" style="background: linear-gradient(135deg, #10b981, #059669);">
                                <i class="fas fa-dollar-sign"></i>
                            </div>
                        </div>
                        <div class="stat-value" id="monthlyRevenue">$9.8k</div>
                        <div class="stat-change">
                            <i class="fas fa-arrow-up"></i> +8.3%
                        </div>
                    </div>

                    <div class="stat-card">
                        <div class="stat-card-header">
                            <h3>Occupied</h3>
                            <div class="stat-icon" style="background: linear-gradient(135deg, #f59e0b, #d97706);">
                                <i class="fas fa-users"></i>
                            </div>
                        </div>
                        <div class="stat-value" id="occupiedUnits">67%</div>
                        <div class="stat-change">
                            <i class="fas fa-arrow-up"></i> +3%
                        </div>
                    </div>

                    <div class="stat-card">
                        <div class="stat-card-header">
                            <h3>Maintenance</h3>
                            <div class="stat-icon" style="background: linear-gradient(135deg, #ef4444, #dc2626);">
                                <i class="fas fa-tools"></i>
                            </div>
                        </div>
                        <div class="stat-value" id="maintenanceRequests">1</div>
                        <div class="stat-change negative">
                            <i class="fas fa-arrow-down"></i> Pending
                        </div>
                    </div>
                </div>
                
                <div class="page-header">
                    <h2 style="font-size: 16px;">Recent Properties</h2>
                </div>
                
                <div class="property-grid" id="recent-properties"></div>
            </div>

            <!-- Properties Page -->
            <div id="properties" class="page">
                <div class="page-header">
                    <h1>Properties</h1>
                    <p>Manage your property portfolio</p>
                </div>

                <div class="search-filter">
                    <div class="search-box">
                        <input type="text" id="search-input" placeholder="Search properties...">
                        <i class="fas fa-search search-icon"></i>
                    </div>
                    <select class="filter-select" id="status-filter">
                        <option value="">All Status</option>
                        <option value="rented">Rented</option>
                        <option value="available">Available</option>
                        <option value="maintenance">Maintenance</option>
                    </select>
                    <select class="filter-select" id="type-filter">
                        <option value="">All Types</option>
                        <option value="apartment">Apartment</option>
                        <option value="house">House</option>
                        <option value="villa">Villa</option>
                    </select>
                </div>

                <div class="property-grid" id="properties-grid"></div>
                
                <div id="empty-state" class="empty-state" style="display: none;">
                    <i class="fas fa-building"></i>
                    <h3>No Properties Found</h3>
                    <p>Add your first property to get started</p>
                </div>
            </div>

            <!-- Add Property Page -->
            <div id="add-property" class="page">
                <div class="add-property-container">
                    <h2 class="title">Property Manager</h2>
                    <p class="subtitle">Add New Commercial Property</p>

                    <div class="step-tabs">
                        <button class="step-btn active" onclick="showStep(1)">Details</button>
                        <button class="step-btn" onclick="showStep(2)">Financials</button>
                        <button class="step-btn" onclick="showStep(3)">Projections</button>
                    </div>

                    <!-- Step 1 -->
                    <div id="step1" class="step-content active">
                        <h3 style="font-size: 15px; margin-bottom: 12px;">Property Details</h3>

                        <div class="upload-section">
                            <label style="display: block; margin-bottom: 8px; font-size: 13px; font-weight: 600;">Property Images</label>
                            <div id="uploadBox" class="upload-box"
                                 onclick="document.getElementById('fileInput').click()">
                                <i class="cloud-icon">‚òÅÔ∏è</i>
                                <p>Tap to upload images</p>
                                <span>PNG, JPG up to 5MB</span>
                                <input id="fileInput" type="file" accept="image/*" multiple onchange="handleFiles(this.files)">
                            </div>
                            <div id="previewContainer" class="preview-container"></div>
                        </div>

                        <div class="form-group">
                            <label>Property Name *</label>
                            <input type="text" id="propertyName" placeholder="e.g., Sunset Apartments">
                        </div>
                        
                        <div class="form-group">
                            <label>Property Type *</label>
                            <select id="propertyType" onchange="updateDynamicField()">
                                <option value="">Select type</option>
                                <option value="villa">Luxury Villa</option>
                                <option value="hotel">Hotel</option>
                                <option value="restaurant">Restaurant</option>
                                <option value="office">Office</option>
                                <option value="industrial">Industrial</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label>Property Value (‚Çπ) *</label>
                            <input type="number" id="purchasePrice" placeholder="Enter value">
                        </div>
                        
                        <div id="dynamicFieldContainer"></div>
                        
                        <div class="form-group">
                            <label>City *</label>
                            <input type="text" id="city" placeholder="Enter city">
                        </div>

                        <div class="buttons">
                            <button class="next-btn" onclick="showStep(2)">Next ‚Üí</button>
                        </div>
                    </div>

                    <!-- Step 2 -->
                  
                    <div id="step2" class="step-content">
  <h3 class="section-title">Step 2 ¬∑ Detailed Annual Operations</h3>
  <p class="subtitle">Calculate baseline Net Operating Income (NOI) using current metrics.</p>

  <div class="sub-tabs">
    <button class="sub-btn active" onclick="showSubTab('revenue')">Revenue Drivers</button>
    <button class="sub-btn" onclick="showSubTab('expenses')">Operating Expenses</button>
    <button class="sub-btn" onclick="showSubTab('finance')">Financing & Investment</button>
  </div>

  <!-- REVENUE -->
  <div id="sub-revenue" class="sub-tab active">
    <div class="card">
      <h4>Core Revenue Drivers</h4>
      <div class="form-row">
        <label>Avg Margin per Gallon (‚Çπ)</label>
        <input type="number" id="avgMargin" value="176" oninput="updateTotals()">
      </div>
      <div class="form-row">
        <label>Avg Daily Gallons Sold (%)</label>
        <input type="number" id="dailyGallons" value="70" oninput="updateTotals()">
      </div>
    </div>

    <div class="card">
      <h4>Ancillary Revenue Streams</h4>
      <div id="extraRevenue"></div>
      <div class="add-row">
        <input type="text" id="newRevName" placeholder="Name">
        <input type="number" id="newRevValue" placeholder="Amount">
        <button onclick="addRevenue()">Add</button>
      </div>
    </div>

    <div class="summary-box">
      <p><b>Total Calculated Revenue:</b> ‚Çπ<span id="totalRevenue">0</span></p>
    </div>
  </div>

  <!-- EXPENSES -->
  <div id="sub-expenses" class="sub-tab">
    <div class="card">
      <h4>Structural & CapEx Maintenance</h4>
      <div id="maintenanceList">
        <div class="expense-item"><input type="text" value="Roof/Foundation"><input type="number" value="50000" oninput="updateTotals()"><button onclick="removeItem(this)">‚úñ</button></div>
        <div class="expense-item"><input type="text" value="HVAC/Plumbing"><input type="number" value="150000" oninput="updateTotals()"><button onclick="removeItem(this)">‚úñ</button></div>
      </div>
    </div>

    <div class="card">
      <h4>Operational Expenses</h4>
      <div id="operatingList">
        <div class="expense-item"><input type="text" value="Staffing & Payroll"><input type="number" value="1550000" oninput="updateTotals()"><button onclick="removeItem(this)">‚úñ</button></div>
        <div class="expense-item"><input type="text" value="Utilities & Services"><input type="number" value="300000" oninput="updateTotals()"><button onclick="removeItem(this)">‚úñ</button></div>
      </div>
    </div>

    <div class="card">
      <h4>Custom Expenses (‚Çπ)</h4>
      <div id="customExpenses"></div>
      <div class="add-row">
        <input type="text" id="customName" placeholder="Name">
        <input type="number" id="customAmount" placeholder="Amount">
        <button onclick="addCustomExpense()">Add</button>
      </div>
    </div>

    <div class="summary-box">
      <p><b>Total Calculated Expenses:</b> ‚Çπ<span id="totalExpenses">0</span></p>
    </div>
  </div>

  <!-- FINANCE -->
  <div id="sub-finance" class="sub-tab">
    <div class="card yellow">
      <h4>Loan Components (P&I)</h4>
      <div id="loanList"></div>
      <button class="add-btn" onclick="addLoan()">+ Add New Loan</button>
    </div>

    <div class="card green">
      <h4>Investment Inputs (Equity & Costs)</h4>
      <div class="form-row">
        <label>Cash Investment (Equity)</label>
        <input type="number" id="cashInvestment" value="5000000" oninput="updateTotals()">
      </div>
      <div class="form-row">
        <label>Closing Costs (% of Purchase Price)</label>
        <input type="number" id="closingCost" value="3" oninput="updateTotals()">
      </div>
    </div>

    <div class="summary-box">
      <p><b>Total Equity Invested:</b> ‚Çπ<span id="totalEquity">0</span></p>
      <p><b>Annual Debt Service (P&I):</b> ‚Çπ<span id="totalLoan">0</span></p>
    </div>
  </div>

  <div class="dynamic-summary">
    <h4>Dynamic Readout</h4>
    <p><b>Total Revenue:</b> ‚Çπ<span id="dynRevenue">0</span></p>
    <p><b>Total Expenses:</b> ‚Çπ<span id="dynExpenses">0</span></p>
    <p><b>Current NOI:</b> ‚Çπ<span id="dynNOI">0</span></p>
  </div>

  <div class="buttons">
    <button class="back-btn" onclick="showStep(1)">‚Üê Back</button>
    <button class="next-btn" onclick="showStep(3)">Next ¬∑ Projections ‚Üí</button>
  </div>
</div>



                    <!-- Step 3 -->
                    <div id="step3" class="step-content">
                        <h3 style="font-size: 15px; margin-bottom: 12px;">Growth Assumptions</h3>

                        <div class="slider-group">
                            <label>Revenue Growth: <span id="revVal">3%</span></label>
                            <input type="range" min="0" max="10" value="3" step="0.1" oninput="updateSlider('revVal', this.value)">
                        </div>

                        <div class="slider-group">
                            <label>Expense Growth: <span id="expVal">2.5%</span></label>
                            <input type="range" min="0" max="10" value="2.5" step="0.1" oninput="updateSlider('expVal', this.value)">
                        </div>

                        <div class="slider-group">
                            <label>Exit Cap Rate: <span id="capVal">7.5%</span></label>
                            <input type="range" min="5" max="15" value="7.5" step="0.1" oninput="updateSlider('capVal', this.value)">
                        </div>

                        <div class="buttons">
                            <button class="back-btn" onclick="showStep(2)">‚Üê Back</button>
                           <button class="next-btn" onclick="saveProperty()">üíæ Save Property</button>

                        </div>
                    </div>
                </div>
            </div>

            <!-- Cash Flow Page -->
            <div id="cash-flow" class="page">
                <div class="page-header">
                    <h1>Cash Flow</h1>
                    <p>Track income and expenses</p>
                </div>

                <div class="cash-flow-cards">
                    <div class="flow-card">
                        <div class="flow-header">
                            <span class="flow-title">Total Income</span>
                            <i class="fas fa-arrow-up" style="color: #10b981; font-size: 18px;"></i>
                        </div>
                        <div class="flow-amount income" id="totalIncome">$9,800</div>
                        <p style="color: #777; font-size: 12px;">This month</p>
                    </div>

                    <div class="flow-card">
                        <div class="flow-header">
                            <span class="flow-title">Total Expenses</span>
                            <i class="fas fa-arrow-down" style="color: #ef4444; font-size: 18px;"></i>
                        </div>
                        <div class="flow-amount expense" id="totalExpenses">$2,450</div>
                        <p style="color: #777; font-size: 12px;">This month</p>
                    </div>

                    <div class="flow-card">
                        <div class="flow-header">
                            <span class="flow-title">Net Profit</span>
                            <i class="fas fa-chart-line" style="color: #667eea; font-size: 18px;"></i>
                        </div>
                        <div class="flow-amount profit" id="netProfit">$7,350</div>
                        <p style="color: #777; font-size: 12px;">This month</p>
                    </div>
                </div>

                <div class="transaction-list">
                    <h3 style="margin-bottom: 12px; color: #333; font-size: 15px;">Recent Transactions</h3>
                    <div id="transactions-list"></div>
                </div>
            </div>

            <!-- Settings Page -->
            <div id="settings" class="page">
                <div class="page-header">
                    <h1>Settings</h1>
                    <p>Manage your preferences</p>
                </div>

                <div class="settings-section">
                    <h3>Profile Settings</h3>
                    <div class="form-group">
                        <label>Full Name</label>
                        <input type="text" value="John Anderson">
                    </div>
                    <div class="form-group">
                        <label>Email Address</label>
                        <input type="email" value="john@propmanager.com">
                    </div>
                    <div class="form-group">
                        <label>Phone Number</label>
                        <input type="tel" value="+1 (555) 123-4567">
                    </div>
                    <button class="btn-primary">
                        <i class="fas fa-save"></i> Save Changes
                    </button>
                </div>

                <div class="settings-section">
                    <h3>Notifications</h3>
                    
                    <div class="setting-item">
                        <div class="setting-info">
                            <h4>Email Notifications</h4>
                            <p>Receive email updates</p>
                        </div>
                        <label class="toggle-switch">
                            <input type="checkbox" checked>
                            <span class="slider"></span>
                        </label>
                    </div>

                    <div class="setting-item">
                        <div class="setting-info">
                            <h4>Payment Reminders</h4>
                            <p>Get rent due notifications</p>
                        </div>
                        <label class="toggle-switch">
                            <input type="checkbox" checked>
                            <span class="slider"></span>
                        </label>
                    </div>

                    <div class="setting-item">
                        <div class="setting-info">
                            <h4>Maintenance Alerts</h4>
                            <p>Receive maintenance updates</p>
                        </div>
                        <label class="toggle-switch">
                            <input type="checkbox" checked>
                            <span class="slider"></span>
                        </label>
                    </div>
                </div>

                <div class="settings-section">
                    <h3>Preferences</h3>
                    
                    <div class="setting-item">
                        <div class="setting-info">
                            <h4>Dark Mode</h4>
                            <p>Enable dark theme</p>
                        </div>
                        <label class="toggle-switch">
                            <input type="checkbox">
                            <span class="slider"></span>
                        </label>
                    </div>

                    <div class="form-group">
                        <label>Currency</label>
                        <select>
                            <option>USD - US Dollar ($)</option>
                            <option>EUR - Euro (‚Ç¨)</option>
                            <option>INR - Indian Rupee (‚Çπ)</option>
                        </select>
                    </div>
                </div>

                <div class="settings-section">
                    <h3>Security</h3>
                    
                    <div class="form-group">
                        <label>Current Password</label>
                        <input type="password" placeholder="Enter current password">
                    </div>
                    <div class="form-group">
                        <label>New Password</label>
                        <input type="password" placeholder="Enter new password">
                    </div>
                    <div class="form-group">
                        <label>Confirm Password</label>
                        <input type="password" placeholder="Confirm new password">
                    </div>
                    
                    <button class="btn-primary">
                        <i class="fas fa-lock"></i> Update Password
                    </button>
                </div>
            </div>
        </main>

        <!-- Bottom Navigation -->
        <nav class="bottom-nav">
            <button class="nav-item active" onclick="showPage('dashboard')">
                <i class="fas fa-home"></i>
                <span>Home</span>
            </button>
            <button class="nav-item" onclick="showPage('properties')">
                <i class="fas fa-building"></i>
                <span>Properties</span>
            </button>
            <button class="nav-item" onclick="showPage('add-property')">
                <i class="fas fa-plus-circle"></i>
                <span>Add</span>
            </button>
            <button class="nav-item" onclick="showPage('cash-flow')">
                <i class="fas fa-chart-line"></i>
                <span>Cash Flow</span>
            </button>
            <button class="nav-item" onclick="showPage('settings')">
                <i class="fas fa-cog"></i>
                <span>Settings</span>
            </button>
        </nav>
    </div>

    <!-- Delete Modal -->
    <div id="delete-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Confirm Delete</h3>
                <button class="modal-close" onclick="closeModal('delete-modal')">&times;</button>
            </div>
            <div class="modal-body">
                <p>Are you sure you want to delete this property? This action cannot be undone.</p>
            </div>
            <div class="modal-footer">
                <button class="btn-secondary" onclick="closeModal('delete-modal')">Cancel</button>
                <button class="btn-danger" id="confirm-delete">Delete</button>
            </div>
        </div>
    </div>

    <script>
        let properties = {
            1: {
                id: 1,
                propertyName: "Sunset Apartments",
                propertyType: "apartment",
                streetAddress: "123 Main St",
                city: "New York",
                state: "NY",
                zipCode: "10001",
                bedrooms: "3",
                bathrooms: "2",
                sqft: "1200",
                monthlyRent: "2500",
                propertyStatus: "rented",
                image: "https://images.unsplash.com/photo-1545324418-cc1a3fa10c00?w=400"
            },
            2: {
                id: 2,
                propertyName: "Ocean View Villa",
                propertyType: "villa",
                streetAddress: "456 Beach Rd",
                city: "Miami",
                state: "FL",
                zipCode: "33101",
                bedrooms: "4",
                bathrooms: "3",
                sqft: "2500",
                monthlyRent: "4200",
                propertyStatus: "available",
                image: "https://images.unsplash.com/photo-1516455590571-18256e5bb9ff?w=400"
            },
            3: {
                id: 3,
                propertyName: "Downtown Loft",
                propertyType: "apartment",
                streetAddress: "789 City Ave",
                city: "Chicago",
                state: "IL",
                zipCode: "60601",
                bedrooms: "2",
                bathrooms: "2",
                sqft: "1800",
                monthlyRent: "3100",
                propertyStatus: "rented",
                image: "https://images.unsplash.com/photo-1512917774080-9991f1c4c750?w=400"
            }
        };
        
        let nextPropertyId = 4;
        let currentDeleteId = null;

        function showPage(pageId) {
            document.querySelectorAll('.page').forEach(page => page.classList.remove('active'));
            document.querySelectorAll('.nav-item').forEach(item => item.classList.remove('active'));
            
            document.getElementById(pageId).classList.add('active');
            
            const navItems = document.querySelectorAll('.nav-item');
            navItems.forEach(item => {
                if (item.getAttribute('onclick')?.includes(pageId)) {
                    item.classList.add('active');
                }
            });
            
            if (pageId === 'properties') renderProperties();
            if (pageId === 'dashboard') updateDashboard();
            if (pageId === 'cash-flow') updateCashFlow();
        }

        function renderProperties() {
            const propertyGrid = document.getElementById('properties-grid');
            const recentProperties = document.getElementById('recent-properties');
            
            if (Object.keys(properties).length === 0) {
                document.getElementById('empty-state').style.display = 'block';
                propertyGrid.innerHTML = '';
                recentProperties.innerHTML = '<p>No properties added yet.</p>';
                return;
            }
            
            document.getElementById('empty-state').style.display = 'none';
            const sortedProperties = Object.values(properties).sort((a, b) => b.id - a.id);
            
            propertyGrid.innerHTML = sortedProperties.map(property => createPropertyCard(property)).join('');
            recentProperties.innerHTML = sortedProperties.slice(0, 3).map(property => createPropertyCard(property)).join('');
            
            filterProperties();
        }

        function createPropertyCard(property) {
            const statusClass = property.propertyStatus === 'rented' ? 'rented' : 
                               property.propertyStatus === 'available' ? 'available' : 'maintenance';
            
            const statusText = property.propertyStatus === 'rented' ? 'Rented' : 
                              property.propertyStatus === 'available' ? 'Available' : 'Maintenance';
            
            return `
                <div class="property-card" data-property-id="${property.id}">
                    <div class="property-image" style="background-image: url('${property.image || 'https://images.unsplash.com/photo-1560518883-ce09059eeffa?w=400'}');">
                        <div class="property-badge ${statusClass}">${statusText}</div>
                    </div>
                    <div class="property-content">
                        <h3 class="property-title">${property.propertyName}</h3>
                        <p class="property-location">
                            <i class="fas fa-map-marker-alt"></i> ${property.streetAddress}, ${property.city}
                        </p>
                        <div class="property-details">
                            <div class="property-detail">
                                <i class="fas fa-bed"></i> ${property.bedrooms} Beds
                            </div>
                            <div class="property-detail">
                                <i class="fas fa-bath"></i> ${property.bathrooms} Bath
                            </div>
                            <div class="property-detail">
                                <i class="fas fa-ruler-combined"></i> ${property.sqft} sqft
                            </div>
                        </div>
                        <div class="property-footer">
                            <div class="property-price">${parseFloat(property.monthlyRent).toLocaleString()}/mo</div>
                            <div class="property-actions">
                                <button class="btn-icon btn-view" onclick="viewProperty(${property.id})" title="View">
                                    <i class="fas fa-eye"></i>
                                </button>
                                <button class="btn-icon btn-clone" onclick="cloneProperty(${property.id})" title="Clone">
                                    <i class="fas fa-copy"></i>
                                </button>
                                <button class="btn-icon btn-edit" onclick="editProperty(${property.id})" title="Edit">
                                    <i class="fas fa-edit"></i>
                                </button>
                                <button class="btn-icon btn-delete" onclick="deleteProperty(${property.id})" title="Delete">
                                    <i class="fas fa-trash"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        function viewProperty(id) {
            const property = properties[id];
            if (!property) return;
            
            alert(`Property: ${property.propertyName}\nType: ${property.propertyType}\nAddress: ${property.streetAddress}, ${property.city}\nBedrooms: ${property.bedrooms}\nBathrooms: ${property.bathrooms}\nRent: ${property.monthlyRent}/mo\nStatus: ${property.propertyStatus}`);
        }

        function cloneProperty(id) {
            const property = properties[id];
            if (!property) return;
            
            if (confirm(`Clone "${property.propertyName}"?`)) {
                const newProperty = { ...property };
                newProperty.id = nextPropertyId++;
                newProperty.propertyName = property.propertyName + " (Copy)";
                
                properties[newProperty.id] = newProperty;
                renderProperties();
                updateDashboard();
                alert('Property cloned successfully!');
            }
        }

        function editProperty(id) {
            alert('Edit functionality - Coming soon!');
        }

        function deleteProperty(id) {
            currentDeleteId = id;
            document.getElementById('delete-modal').classList.add('active');
        }

        document.getElementById('confirm-delete').addEventListener('click', function() {
            if (!currentDeleteId) return;
            
            delete properties[currentDeleteId];
            renderProperties();
            updateDashboard();
            updateCashFlow();
            
            closeModal('delete-modal');
            alert('Property deleted successfully.');
        });

        function closeModal(modalId) {
            document.getElementById(modalId).classList.remove('active');
            currentDeleteId = null;
        }

        function filterProperties() {
            const searchTerm = document.getElementById('search-input').value.toLowerCase();
            const statusFilter = document.getElementById('status-filter').value;
            const typeFilter = document.getElementById('type-filter').value;
            
            const propertyCards = document.querySelectorAll('.property-card');
            let visibleCount = 0;
            
            propertyCards.forEach(card => {
                const id = card.getAttribute('data-property-id');
                const property = properties[id];
                
                if (!property) return;
                
                const matchesSearch = property.propertyName.toLowerCase().includes(searchTerm) || 
                                    property.streetAddress.toLowerCase().includes(searchTerm) ||
                                    property.city.toLowerCase().includes(searchTerm);
                
                const matchesStatus = !statusFilter || property.propertyStatus === statusFilter;
                const matchesType = !typeFilter || property.propertyType === typeFilter;
                
                if (matchesSearch && matchesStatus && matchesType) {
                    card.style.display = 'block';
                    visibleCount++;
                } else {
                    card.style.display = 'none';
                }
            });
            
            document.getElementById('empty-state').style.display = visibleCount === 0 ? 'block' : 'none';
        }

        function updateDashboard() {
            const totalProperties = Object.keys(properties).length;
            const rentedProperties = Object.values(properties).filter(p => p.propertyStatus === 'rented').length;
            const maintenanceProperties = Object.values(properties).filter(p => p.propertyStatus === 'maintenance').length;
            
            const monthlyRevenue = Object.values(properties).reduce((total, property) => {
                return total + (property.propertyStatus === 'rented' ? parseFloat(property.monthlyRent) : 0);
            }, 0);
            
            const occupancyRate = totalProperties > 0 ? Math.round((rentedProperties / totalProperties) * 100) : 0;
            
            document.getElementById('totalProperties').textContent = totalProperties;
            document.getElementById('monthlyRevenue').textContent = `${(monthlyRevenue/1000).toFixed(1)}k`;
            document.getElementById('occupiedUnits').textContent = `${occupancyRate}%`;
            document.getElementById('maintenanceRequests').textContent = maintenanceProperties;
        }

        function updateCashFlow() {
            const totalIncome = Object.values(properties).reduce((total, property) => {
                return total + (property.propertyStatus === 'rented' ? parseFloat(property.monthlyRent) : 0);
            }, 0);
            
            const totalExpenses = Math.round(totalIncome * 0.25);
            const netProfit = totalIncome - totalExpenses;
            
            document.getElementById('totalIncome').textContent = `${totalIncome.toLocaleString()}`;
            document.getElementById('totalExpenses').textContent = `${totalExpenses.toLocaleString()}`;
            document.getElementById('netProfit').textContent = `${netProfit.toLocaleString()}`;
            
            updateTransactions();
        }

        function updateTransactions() {
            const transactionsList = document.getElementById('transactions-list');
            const rentedProperties = Object.values(properties).filter(p => p.propertyStatus === 'rented');
            
            if (rentedProperties.length === 0) {
                transactionsList.innerHTML = '<p style="text-align: center; color: #999; padding: 20px 0;">No recent transactions</p>';
                return;
            }
            
            const transactions = rentedProperties.map(property => {
                const date = new Date();
                date.setDate(date.getDate() - Math.floor(Math.random() * 7));
                
                return {
                    name: `Rent - ${property.propertyName}`,
                    date: date.toLocaleDateString(),
                    amount: parseFloat(property.monthlyRent)
                };
            });
            
            transactions.sort((a, b) => new Date(b.date) - new Date(a.date));
            
            transactionsList.innerHTML = transactions.map(t => `
                <div class="transaction-item">
                    <div class="transaction-info">
                        <h4>${t.name}</h4>
                        <p>${t.date}</p>
                    </div>
                    <div class="transaction-amount income">
                        +${t.amount.toLocaleString()}
                    </div>
                </div>
            `).join('');
        }

        function showStep(step) {
            document.querySelectorAll('.step-btn').forEach(btn => btn.classList.remove('active'));
            document.querySelectorAll('.step-content').forEach(sec => sec.classList.remove('active'));
            document.querySelector(`.step-btn:nth-child(${step})`).classList.add('active');
            document.getElementById(`step${step}`).classList.add('active');
        }

       function showSubTab(tab) {
  document.querySelectorAll('.sub-tab').forEach(e => e.classList.remove('active'));
  document.querySelectorAll('.sub-btn').forEach(e => e.classList.remove('active'));
  document.getElementById('sub-' + tab).classList.add('active');
  document.querySelector(`.sub-btn[onclick="showSubTab('${tab}')"]`).classList.add('active');
}
function removeItem(btn){btn.parentElement.remove();updateTotals();}

function addRevenue(){
  const n=document.getElementById("newRevName").value,v=document.getElementById("newRevValue").value;
  if(!n||!v)return alert("Enter name & amount");
  const d=document.createElement("div");
  d.className="expense-item";
  d.innerHTML=`<input type="text" value="${n}"><input type="number" value="${v}" oninput="updateTotals()"><button onclick="removeItem(this)">‚úñ</button>`;
  document.getElementById("extraRevenue").appendChild(d);
  document.getElementById("newRevName").value="";document.getElementById("newRevValue").value="";
  updateTotals();
}

function addCustomExpense(){
  const n=document.getElementById("customName").value,v=document.getElementById("customAmount").value;
  if(!n||!v)return alert("Enter name & amount");
  const d=document.createElement("div");
  d.className="expense-item";
  d.innerHTML=`<input type="text" value="${n}"><input type="number" value="${v}" oninput="updateTotals()"><button onclick="removeItem(this)">‚úñ</button>`;
  document.getElementById("customExpenses").appendChild(d);
  document.getElementById("customName").value="";document.getElementById("customAmount").value="";
  updateTotals();
}
function addLoan(){
  const d=document.createElement("div");
  d.className="expense-item";
  d.innerHTML=`<input type="text" placeholder="Loan Name"><input type="number" placeholder="Amount" oninput="updateTotals()"><button onclick="removeItem(this)">‚úñ</button>`;
  document.getElementById("loanList").appendChild(d);
  updateTotals();
}

function updateTotals(){
  const numSum=id=>[...document.querySelectorAll(`#${id} input[type=number]`)]
    .reduce((a,i)=>a+Number(i.value||0),0);
  const rev=numSum('extraRevenue')+Number(document.getElementById('avgMargin').value||0)*Number(document.getElementById('dailyGallons').value||0);
  const exp=numSum('maintenanceList')+numSum('operatingList')+numSum('customExpenses');
  const loans=numSum('loanList');
  const equity=Number(document.getElementById('cashInvestment').value||0)+
               (Number(document.getElementById('closingCost').value||0)/100)*Number(document.getElementById('cashInvestment').value||0);
  const noi=rev-exp;

  document.getElementById('totalRevenue').textContent=rev.toLocaleString();
  document.getElementById('totalExpenses').textContent=exp.toLocaleString();
  document.getElementById('totalEquity').textContent=equity.toLocaleString();
  document.getElementById('totalLoan').textContent=loans.toLocaleString();
  document.getElementById('dynRevenue').textContent=rev.toLocaleString();
  document.getElementById('dynExpenses').textContent=exp.toLocaleString();
  document.getElementById('dynNOI').textContent=noi.toLocaleString();
}
updateTotals();
        function updateSlider(id, val) {
            document.getElementById(id).innerText = val + '%';
        }

        function updateDynamicField() {
            const container = document.getElementById("dynamicFieldContainer");
            const type = document.getElementById("propertyType").value;
            container.innerHTML = "";

            if (!type) return;

            const fields = {
                villa: { label: "Total Rental Units", placeholder: "e.g. 5" },
                hotel: { label: "Total Rooms", placeholder: "e.g. 80" },
                restaurant: { label: "Seating Capacity", placeholder: "e.g. 50" },
                office: { label: "Total Offices", placeholder: "e.g. 10" },
                industrial: { label: "Warehouse Units", placeholder: "e.g. 3" }
            };

            const field = fields[type];
            container.innerHTML = `
                <div class="form-group">
                    <label>${field.label}</label>
                    <input type="text" id="dynamicInput" placeholder="${field.placeholder}">
                </div>
            `;
        }

        function handleFiles(files) {
            const preview = document.getElementById("previewContainer");
            preview.innerHTML = "";
            Array.from(files).forEach(file => {
                if (file.type.startsWith("image/")) {
                    const reader = new FileReader();
                    reader.onload = e => {
                        const img = document.createElement("img");
                        img.src = e.target.result;
                        preview.appendChild(img);
                    };
                    reader.readAsDataURL(file);
                }
            });
        }

      

            function addRevenue() {
  const name = document.getElementById("newRevName").value;
  const value = document.getElementById("newRevValue").value;
  if (!name || !value) return alert("Enter name & amount");

  const div = document.createElement("div");
  div.className = "revenue-item";
  div.innerHTML = `<input type="text" value="${name}">
                   <input type="number" value="${value}">
                   <button onclick="this.parentElement.remove()">‚úñ</button>`;
  document.getElementById("extraRevenue").appendChild(div);

  document.getElementById("newRevName").value = "";
  document.getElementById("newRevValue").value = "";
}

function saveProperty() {
            // Validate Step 1 fields
            const propertyName = document.getElementById("propertyName").value.trim();
            const propertyType = document.getElementById("propertyType").value;
            const purchasePrice = document.getElementById("purchasePrice").value;
            const city = document.getElementById("city").value.trim();
            
            if (!propertyName || !propertyType || !purchasePrice || !city) {
                alert("Please fill in all required fields in Step 1");
                showStep(1);
                return;
            }

            // Get dynamic field value
            const dynamicInput = document.getElementById("dynamicInput");
            const dynamicValue = dynamicInput ? dynamicInput.value : "";

            // Get Step 2 financial data
            const totalRevenue = document.getElementById("totalRevenue").textContent.replace(/,/g, '');
            const totalExpenses = document.getElementById("totalExpenses").textContent.replace(/,/g, '');
            const noi = document.getElementById("dynNOI").textContent.replace(/,/g, '');
            const totalEquity = document.getElementById("totalEquity").textContent.replace(/,/g, '');

            // Get Step 3 projections
            const revGrowth = document.getElementById("revVal").textContent;
            const expGrowth = document.getElementById("expVal").textContent;
            const exitCap = document.getElementById("capVal").textContent;

            // Get images from preview
            const images = Array.from(document.querySelectorAll('#previewContainer img'))
                .map(img => img.src);
            const mainImage = images.length > 0 ? images[0] : 'https://images.unsplash.com/photo-1560518883-ce09059eeffa?w=400';

            // Create new property matching the existing structure
            const newProperty = {
                id: nextPropertyId++,
                propertyName: propertyName,
                propertyType: propertyType,
                streetAddress: dynamicValue || "N/A",
                city: city,
                state: "N/A",
                zipCode: "N/A",
                bedrooms: "N/A",
                bathrooms: "N/A",
                sqft: dynamicValue || "N/A",
                monthlyRent: purchasePrice,
                propertyStatus: "available",
                image: mainImage,
                // Additional financial data
                financials: {
                    purchasePrice: purchasePrice,
                    totalRevenue: totalRevenue,
                    totalExpenses: totalExpenses,
                    noi: noi,
                    totalEquity: totalEquity,
                    revGrowth: revGrowth,
                    expGrowth: expGrowth,
                    exitCap: exitCap
                }
            };

            // Add to properties object
            properties[newProperty.id] = newProperty;

            // Clear form
            document.getElementById("propertyName").value = "";
            document.getElementById("propertyType").value = "";
            document.getElementById("purchasePrice").value = "";
            document.getElementById("city").value = "";
            document.getElementById("previewContainer").innerHTML = "";
            document.getElementById("dynamicFieldContainer").innerHTML = "";

            // Reset to step 1
            showStep(1);

            // Update displays
            renderProperties();
            updateDashboard();
            updateCashFlow();

            // Show success message and navigate
            alert("‚úÖ Property saved successfully!");
            showPage('properties');
        }

        document.addEventListener('DOMContentLoaded', function() {
            ['search-input', 'status-filter', 'type-filter'].forEach(id => {
                const element = document.getElementById(id);
                if (element) {
                    element.addEventListener(id === 'search-input' ? 'input' : 'change', filterProperties);
                }
            });

            renderProperties();
            updateDashboard();
            updateCashFlow();
        });
    </script>
</body>
</html>